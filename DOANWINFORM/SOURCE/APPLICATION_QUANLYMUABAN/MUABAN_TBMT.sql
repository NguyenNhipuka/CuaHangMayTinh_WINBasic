CREATE DATABASE DATABASE_QLCHTBMT5

---=================THIETBI======================
CREATE TABLE THIETBI
(
LOAI NVARCHAR(20) NOT NULL,
MA_TB nCHAR(7) NOT NULL,
TEN_TB NVARCHAR(70)NOT NULL,
MA_NCC nCHAR(7)NOT NULL,
SOLUONG  INT NOT NULL,
TG_BAOHANH INT,
DONGIA_MUA DECIMAL(18,3) NOT NULL,
DONGIA_BAN DECIMAL(18,3)NOT NULL,
NSX NVARCHAR(20),
CONSTRAINT PK_THIETBI PRIMARY KEY(MA_TB)
)
-----=====================NHACUNGCAP
CREATE TABLE NHACUNGCAP
(
MA_NCC nCHAR(7)NOT NULL,
TEN_NCC NVARCHAR(100)NOT NULL,
DIACHI NVARCHAR(100),
DIENTHOAI NVARCHAR(12) NOT NULL,
EMAIL NVARCHAR(30)NOT NULL,
CONSTRAINT PK_NHACUNGCAP PRIMARY KEY(MA_NCC)
)

-----==========================NHANVIEN
CREATE TABLE NHANVIEN(
MA_NV nCHAR(7) NOT NULL,
TEN_NV NVARCHAR(60) NOT NULL,
PHAI NVARCHAR(3) NOT NULL,
NGAYSINH NCHAR(11),
DIENTHOAI NVARCHAR(12) NOT NULL,
DIACHI NVARCHAR(100)NOT NULL,
CHUCVU NVARCHAR(20)NOT NULL,
CONSTRAINT PK_NV PRIMARY KEY(MA_NV)
)

----========================TAIKHOAN_NV
CREATE TABLE TAIKHOAN_NV(
MA_NV nCHAR(7)NOT NULL,
PASS NVARCHAR(30)NOT NULL,
CV nvarchar(20)
CONSTRAINT PK_TKNV PRIMARY KEY(MA_NV),
)

-----========================HOADONBAN
CREATE TABLE HOADON_BAN(
MA_HDB nCHAR(11)NOT NULL,
TEN_KH NVARCHAR(60)NOT NULL,
SDT NVARCHAR(12)NOT NULL,
NGAYLAP DATETIME NOT NULL,
TRIGIA_HDB DECIMAL(18,3)NOT NULL,
MA_NV nCHAR(7)NOT NULL,
CONSTRAINT PK_HOADONBAN PRIMARY KEY(MA_HDB)
)


----=============================CHITIET_HDB
CREATE TABLE CHITIET_HDB(
MA_HDB nCHAR(11)NOT NULL,
MA_TB nCHAR(7)NOT NULL,
SOLUONG INT NOT NULL,
DONGIA DECIMAL(18,3) NOT NULL,
THANHTIEN DECIMAL(18,3) NOT NULL,
CONSTRAINT PK_CTHDB PRIMARY KEY(MA_HDB,MA_TB)
)


-------============================HOADONMUA
CREATE TABLE HOADON_MUA(
MA_HDM nCHAR(11) NOT NULL,
MA_NCC nCHAR(7) NOT NULL,
NGAYLAP DATETIME NOT NULL,
TRIGIA_HDM DECIMAL(18,3) NOT NULL,
MA_NV nCHAR(7) NOT NULL,
CONSTRAINT PK_HDM PRIMARY KEY(MA_HDM)
)

---===============================CHIET_HDM
CREATE TABLE CHITIET_HDM(
MA_HDM nCHAR(11),
MA_TB nCHAR(7),
SOLUONG INT,
DONNGIA_MUA DECIMAL(18,3),
THANHTIEN DECIMAL(18,3),
CONSTRAINT PK_CTHDM PRIMARY KEY(MA_HDM,MA_TB)
)


-----===============================BangBaoGia
CREATE TABLE BANGBAOGIA
(
	LOAI NVARCHAR(20) NOT NULL,
	MA_TB nCHAR(7) NOT NULL  primary key,
	TEN_TB NVARCHAR(70)NOT NULL,
	SOLUONG  INT NOT NULL,
	TG_BAOHANH INT,
	DONGIA_BAN DECIMAL(18,3)NOT NULL,
	NSX NVARCHAR(20),
)

---============================ BangBaoCaoThuChi
CREATE TABLE BAOCAOTHUCHI
(
	MAPHIEU NCHAR(11) NOT NULL PRIMARY KEY,
	NGAYLAP DATETIME NOT NULL,
	TRIGIA_HD DECIMAL(18,3)NOT NULL,
	TENNV NVARCHAR(60),
	TONG DECIMAL (18,3)
)

select * FROM BAOCAOTHUCHI

-----------========KHOA==================
ALTER TABLE THIETBI
ADD FOREIGN KEY(MA_NCC) REFERENCES NHACUNGCAP (MA_NCC)


ALTER TABLE HOADON_BAN
ADD FOREIGN KEY(MA_NV) REFERENCES  NHANVIEN(MA_NV)

ALTER TABLE CHITIET_HDB
ADD FOREIGN KEY(MA_TB) REFERENCES THIETBI (MA_TB),
FOREIGN KEY(MA_HDB) REFERENCES HOADON_BAN (MA_HDB)


ALTER TABLE HOADON_MUA
ADD FOREIGN KEY (MA_NCC) REFERENCES NHACUNGCAP (MA_NCC),
FOREIGN KEY (MA_NV) REFERENCES NHANVIEN (MA_NV)

ALTER TABLE CHITIET_HDM
ADD FOREIGN KEY (MA_TB) REFERENCES THIETBI (MA_TB),
FOREIGN KEY (MA_HDM) REFERENCES HOADON_MUA (MA_HDM)

----------------------------------------------

INSERT INTO NHACUNGCAP
VALUES('NC0001',N'Công Ty TNHH Một Thành Viên Thương Mại - Dịch Vụ Nhật Thiên Thanh',N'BÌNH DƯƠNG','06503902309','nhatthienthanh@gmail.com'),
('NC0002',N'Công Ty TNHH Vi Tính Nguyên Kim Chính Nhân',N'TPHCM','01637383899','nguyenkim22@gmail.com'),
('NC0003',N'Công ty TNHH Minh Tiến',N'TPHCM','01625262789','minhtien@gmail.com'),
('NC0004',N'Công Ty TNHH Điện Tử - Tin Học Từ Sơn',N'TPHCM','01637389','tuson@gmail.com'),
('NC0005',N'Công Ty TNHH Tin Học Tiên Phong',N'HÀ NỘI','01633637788','TP@gmail.com'),
('NC0006',N'Công ty TNHH Thương Mại Dịch Vụ Tin Học Và Viễn Thông Hoàng Nhân',N'TPHCM','083378494','hoangnhan@gmail.com'),
('NC0007',N'Công Ty TNHH Hoàng Trung Nhuận (SM&YOU)',N'TPHCM','0163378798','trungthuan@gmail.com')

SELECT * FROM NHACUNGCAP


INSERT INTO THIETBI VALUES
(N'BÀN PHÍM','000001',N'Bàn phím A4 Tech K.83.U','NC0001',10,12,142000,160000,N'ACER'),
(N'BÀN PHÍM','000002',N'Genius Luxepad 9100 Bluetooth','NC0002',53,12,75000,90000,N'ASUS'),
(N'BÀN PHÍM','000003',N'Sumtax For-1','NC0003',35,12,265000,280000,N'ACER'),
(N'BÀN PHÍM','000010',N'Keyboard  Mitsumi - PS2 Port','NC0004',5,12,210000,230000,N'MITSUMI'),
(N'BÀN PHÍM','000011',N'Keyboard Nimbus Value - PS2 Port','NC0005',8,12,220000,230000,N'NIMBUS'),
(N'CHUỘT','000004',N'Logitech M337(Đen)','NC0002',12,12,569000,575000,N'ACER'),
(N'CHUỘT','000005',N'Sumtax Fox-5','NC0003',100,12,150000,160000,N'DELL'),
(N'CHUỘT','000006',N'R8 1617(đen)','NC0004',100,12,133000,145000,N'ACER'),
('RAM','000007',N'RAM 1 GB EVMBus 800','NC0001',7,36,133000,145000,N'ACER'),
('POWER','000008',N'Power Supply PIV 480W/ 24 Pin  - ATX - Vicom/ Codegen/ GoldenFiel','NC0005',4,12,400000,450000,N'ATX'),
('POWER','000009',N'Power Supply PIV 500W/ 24 Pin  - ATX - Vicom/ Codegen/ GoldenFieldl','NC0001',5,12,470000,500000,N'ATX'),
(N'VGA','000012',N'VGA Nvidia - FX5200','NC0003',8,12,800000,830000,N'NVIDIA'),
(N'VGA','000013',N'VGA ATI RADEON 9000 - 256 MB - 128 Bit','NC0002',8,12,890000,950000,N'RADEON'),
(N'CDROM','000014',N'Samsung CDRom 52X max (Black/ White)','NC0002',8,12,350000,400000,N'SAMSUNG'),
(N'CDROM','000015',N'LG CDRom 52X max (Black/ White)','NC0001',8,12,350000,400000,N'LG'),
(N'LOA','000016',N'Microlab Subwoofer M880 - 2.1 (400W)','NC0002',8,12,1060000,1020000,N'SUBWOOFER'),
(N'LOA','000017',N'Genius Speaker S110/ P110 - 2.0 (100W)','NC0004',8,12,200000,225000,N'GENIUS'),
(N'USB','000018',N'USB Flashdisk  - 2 GB','NC0005',8,12,230000,245000,N'KINGSTON'),
(N'USB','000019',N'USB Flashdisk  - 4 GB','NC0003',8,12,250000,265000,N'JORG')

SELECT * FROM THIETBI






SET DATEFORMAT DMY
INSERT INTO NHANVIEN
VALUES('NV0001',N'NGUYỄN THỊ YẾN NHI',N'NỮ','30/08/1996','0988207865',N'TPHCM',N'GIÁM ĐỐC'),
('NV0002',N'NGUYỄN THỊ THẢO QUYÊN',N'NỮ','01/04/1996','01667865609',N'TPHCM',N'NHÂN VIÊN'),
('NV0003',N'NGUYỄN THỊ HUỲNH NHƯ',N'NỮ','10/02/1996','0988207867',N'VŨNG TÀU',N'THỦ KHO')

SELECT*FROM TAIKHOAN_NV



INSERT INTO TAIKHOAN_NV VALUES
('NV0001','123',N'GIÁM ĐỐC'),
('NV0002','123',N'NHÂN VIÊN'),
('NV0003','123',N'THỦ KHO')
SET DATEFORMAT DMY
-----------------------------------


SET DATEFORMAT DMY
INSERT INTO HOADON_MUA VALUES
('M000000001','NC0005','2/1/2015',1020000,'NV0003'),
('M000000002','NC0004','12/1/2015',1829000,'NV0003'),
('M000000003','NC0003','05/12/2015',1250000,'NV0003'),
('M000000004','NC0002','20/1/2015',4537000,'NV0003'),
('M000000005','NC0001','16/8/2015',633000,'NV0003'),
('M000000006','NC0001','02/9/2013',1836000,'NV0003'),
('M000000007','NC0002','13/10/2016',2757000,'NV0003'),
('M000000008','NC0003','24/05/2015',4480000,'NV0003')



SET DATEFORMAT DMY
INSERT INTO CHITIET_HDM
VALUES
('M000000001','000008',2,400000,800000),
('M000000001','000011',1,220000,220000),
('M000000002','000006',3,133000,399000),
('M000000002','000010',3,210000,630000),
('M000000002','000017',4,200000,800000),
('M000000003','000019',5,250000,1250000),
('M000000004','000013',2,890000,1780000),
('M000000004','000014',3,350000,1050000),
('M000000004','000004',3,569000,1707000),
('M000000005','000007',1,133000,133000),
('M000000005','000009',3,4700000,500000),
('M000000006','000015',2,350000,1410000),
('M000000006','000001',3,142000,426000),
('M000000007','000004',3,569000,1707000),
('M000000007','000014',3,350000,1050000),
('M000000008','000012',4,800000,3200000),
('M000000008','000019',3,250000,750000),
('M000000008','000003',2,265000,530000)



select * from CHITIET_HDM

 SET DATEFORMAT DMY
INSERT INTO HOADON_BAN VALUES
('B000000001',N'VÕ THỊ TƯỜNG VI','0988207865','20/10/2016',1780000,'NV0002'),
('B000000002',N'NGUYỄN TAN NHƯ','01238656544','2/10/2016',3725000,'NV0002'),
('B000000003',N'VÕ THỊ TƯỜNG VI','0988207865','7/12/2015',1150000,'NV0002'),
('B000000004',N'NGUYỄN MINH TÂM','01667865609','28/10/2016',1810000,'NV0001'),
('B000000005',N'NGUYỄN THƯ HUYỀN','01667865609','22/10/2016',8400000,'NV0001'),
('B000000006',N'NGUYỄN MINH TÂM','01667865609','28/10/2016',8660000,'NV0002'),
('B000000007',N'TRẦN MINH DŨNG','0123451209','28/10/2016',7000000,'NV0001')
select*from HOADON_BAN


INSERT INTO CHITIET_HDB VALUES
('B000000001','000001',1,160000,160000),
('B000000001','000003',2,280000,560000),
('B000000001','000005',3,160000.000,480000.000),
('B000000001','000007',4,145000.000,580000.000),
('B000000002','000002',3,90000.000,270000.000),
('B000000002','000004',5,575000.000,2875000),
('B000000002','000006',4,145000.000,580000),
('B000000003','000004',2,575000.000,1150000),
('B000000004','000008',3,450000.000,1350000),
('B000000004','000011',2,230000.000,460000),
('B000000005','000009',3,500000.000,1500000),
('B000000005','000010',3,230000.000,690000),
('B000000006','000012',2,830000.000,1660000),
('B000000006','000014',2,400000.000,800000),
('B000000007','000013',4,950000.000,3800000),
('B000000007','000014',4,400000.000,1600000),
('B000000007','000015',4,400000.000,1600000)


select*from CHITIET_HDB

---------------------------------------------------------chay toi day nek--------------------------------------------------------------------
DELETE CHITIET_HDB
WHERE MA_HDB = 'B0000000008'

DELETE HOADON_BAN
WHERE MA_HDB = 'B0000000008'

SELECT * FROM THIETBI

